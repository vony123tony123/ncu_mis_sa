<!DOCTYPE html>
<html>
<head>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>保險資訊確認</title>


    <script src="statics/js/jquery-3.4.1.min.js"></script>
    
    <!-- Bootstrap core CSS -->
	<link href="statics/css/bootstrap.min.css" rel="stylesheet">
    <link href="statics/css/insurance.css" rel="stylesheet">
	<link href="statics/css/font-awesome.min.css" rel="stylesheet">
	<link href="statics/icon/insurance.ico" type="image/x-icon" rel="icon">
	<link href="statics/icon/insurance.ico" type="image/x-icon" rel="shortcut icon">

	<script src="statics/js/jquery-3.4.1.min.js"></script>
	<script src="statics/js/jquery-confirm.js"></script>
    
</head>
<body>

<div
		class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 border-bottom shadow-sm"
		style="background-color: rgb(214, 236, 243);">
		<img src="./statics/img/insurance.png"
			style="width: 40px; height: 40px;">
		<h5 class="my-0 mr-md-auto font-weight-normal">OOO保險公司</h5>
		<nav class="my-2 my-md-0 mr-md-3">
			<a  class="p-2 text-dark" href="memberIndex.html">會員管理</a> <a
				class="p-2 text-dark" href="insuranceIndex.html">保險管理</a> <a
				class="p-2 text-dark" href="insurancePolicyIndex.html">保單管理</a>
			<a class="btn btn-outline-primary" href="login.html">登出</a>
		</nav>
</div>
		

	<div
		class="pricing-header px-3 py-1 pt-md-2 pb-md-2 mx-auto text-center bg-light"
		style="font-family: DFKai-sb;">
		<h4 class="display-4">保險資訊</h4>
	</div>

	<div class="container" style="font-family: Microsoft JhengHei;">
		<div class="py-2">
			<div class="my-3 bg-white rounded box-shadow">
				<h4 class="mb-3">保險資訊</h4>
				<hr class="mb-2">
				<div class="row">
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">保險名稱</strong> <span
								id="insurace_name">{{insurace_name}}</span>
						</p>
					</div>
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">保險有效時間</strong> <span
								id="duration_period">{{duration_period}}</span>
						</p>
					</div>
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">保險金額</strong> <span
								id="amount_insured">{{amount_insured}}</span>
						</p>
					</div>
				</div>
				<div class="media text-muted pt-3">
					<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
						<strong class="d-block text-gray-dark pre-wrap">保險敘述</strong> <span
							id="insurance_detail">{{insurance_detail}}</span>
					</p>
				</div>
			</div>

			<div>
				<h4 class="mb-3 mt-5">要保人資訊</h4>
				<hr class="mb-4">
				<div class="row">
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">要保人名稱</strong> <span
								id="member_name">{{member_name}}</span>
						</p>
					</div>
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">要保人身份證字號</strong> <span
								id="member_id">{{member_id}}</span>
						</p>
					</div>
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">要保人生日</strong> <span
								id="member_birthday">{{member_birthday}}</span>
						</p>
					</div>
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">要保人性別</strong> <span
								id="member_gender">{{member_gender}}</span>
						</p>
					</div>
				</div>
				<div class="row">
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">要保人信箱</strong> <span
								id="member_email">{{member_email}}</span>
						</p>
					</div>
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">要保人身高/體重</strong> <span
								id="member_height">{{member_height}}</span> cm/ <span
								id="member_weight">{{member_weight}}</span> kg
						</p>
					</div>
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">要保人地址</strong> <span
								id="member_address">{{member_address}}</span>
						</p>
					</div>
				</div>
				<div class="row">
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">要保人電話</strong> <span
								id="member_phone_number">{{member_phone_number}}</span>
						</p>
					</div>
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">要保人疾病</strong> <span
								id="member_disease">{{member_disease}}</span>
						</p>
					</div>
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">銀行帳號</strong> <span
								id="member_bank_account">{{member_bank_account}}</span>
						</p>
					</div>
				</div>
			</div>
			<div>
				<h4 class="mb-3 mt-5">保單資訊</h4>
				<hr class="mb-4">
				<div class="row">
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">保單編號</strong> <span
								id="insurance_policy_id">{{insurance_policy_id}}</span>
						</p>
					</div>
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">年繳保費</strong> <span
								id="insurance_premium">{{insurance_premium}}</span>
						</p>
					</div>
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">受益人姓名 </strong> <span
								id="beneficiary_name">{{beneficiary_name}}</span>
						</p>
					</div>
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">受益人關係</strong> <span
								id="beneficiary_relationship">{{beneficiary_relationship}}</span>
						</p>
					</div>
				</div>
				<div class="row">
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">受益人電話</strong> <span
								id="beneficiary_phone_number">{{beneficiary_phone_number}}</span>
						</p>
					</div>
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">受益人住址</strong> <span
								id="beneficiary_address">{{beneficiary_address}}</span>
						</p>
					</div>
				</div>
				<div class="row">
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">保單建立日期</strong> <span
								id="create_time">{{create_time}}</span>
						</p>
					</div>
					<div class="col media text-muted pt-3">
						<p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
							<strong class="d-block text-gray-dark">保單上次修改日期</strong> <span
								id="modify_time">{{modify_time}}</span>
						</p>
					</div>
				</div>
			</div>
			<div
				class="d-flex justify-content-between mx-auto align-items-center"
				style="width: 500px; height: 50px;">
				<a id="back_button" class="btn btn-success" type="button"
					href="insurancePolicyIndex.html">回上一頁</a> <a id="change_button"
					class="btn btn-primary" href="insurance.html" type="button">我要修改受益人資料</a>
			</div>
		</div>
	</div>

	<script>
		var url_string = window.location.href;
		var url = new URL(url_string);
		var insurance_policy_id = url.searchParams.get("insurance_policy_id");
		var isManager = localStorage.getItem("isManager");
		
		$('#change_button').attr('href','insurancePolicyEdit.html?insurance_policy_id='+ insurance_policy_id +'');

		getInsurancePolicyData();

		function getInsurancePolicyData() {
			$.ajax({
						type : "Get",
						url : "api/insurancePolicy.do",
						data : "insurance_policy_id=" + insurance_policy_id,
						crossDomain : true,
						cache : false,
						dataType : 'json',
						timeout : 5000,
						success : function(response) {
							if (response.status == 200) {
								updateMemberHtml(response.response.data['MemberInfo'].data[0]);
								updateInsuranceHtml(response.response.data['InsuranceInfo'].data[0]);
								updateInsurancePolicyHtml(response.response.data['InsurancePolicyInfo']);
							}
						},
						error : function() {
							alert("無法連線到伺服器！");
						}
					})
		}

		function updateMemberHtml(data) {
			$("#member_name").html(data['name']);
			$("#member_id").html(data['id']);
			$("#member_birthday").html(data['birthday']);

			switch (data['gender']) {
			case 0:
				$("#member_gender").html("女");
				break;
			case 1:
				$("#member_gender").html("男");
				break;
			}

			$("#member_email").html(data['email']);
			$("#member_height").html(data['height']);
			$("#member_weight").html(data['weight']);
			$("#member_address").html(data['address']);
			$("#member_phone_number").html(data['phone_number']);

			switch (data['disease_id']) {
			case 0:
				$("#member_disease").html("無疾病");
				break;
			case 1:
				$("#member_disease").html("天生疾病");
				break;
			case 2:
				$("#member_disease").html("重大傷病");
				break;
			case 3:
				$("#member_disease").html("其他");
				break;
			}
			$("#member_bank_account").html(data['bank_account']);
		}

		function updateInsuranceHtml(data) {
			$("#insurace_name").html(data['insurance_name']);
			$("#duration_period").html(data['duration_period']);
			$("#amount_insured").html(data['amount_insured']);
			$("#insurance_detail").html(data['details']);
		}
		
		function updateInsurancePolicyHtml(data){
			$("#insurance_policy_id").html(data['insurance_policy_id']);
			$("#insurance_premium").html(data['insurance_premium']);
			$("#beneficiary_name").html(data['beneficiary_name']);
			$("#beneficiary_relationship").html(data['beneficiary_relationship']);
			$("#beneficiary_phone_number").html(data['beneficiary_phone_number']);
			$("#beneficiary_address").html(data['beneficiary_address']);
			$("#create_time").html(data['create_time']);
			$("#modify_time").html(data['modify_time']);
		}
		
	</script>
</body>
</html>